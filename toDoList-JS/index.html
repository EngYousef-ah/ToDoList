<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>To-Do-List</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- EXTERNAL LIBRARIES -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Alexandria:wght@100..900&family=Tajawal:wght@200;300;400;500;700;800;900&display=swap"
    rel="stylesheet">

  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&" />

  <style>
    body {
      padding: 0;
      margin: 0;
      box-sizing: border-box;
      background-color: rgb(23, 23, 70);
      font-family: 'Tajawal', sans-serif;
    }

    .task {
      display: flex;
      background: #fff;
      padding: 6px;
      border: solid 1px black;
    }

    .task:hover {
      transform: scale(1.02);
      transition: all .3s;
      box-shadow: 0px 3px 10px rgba(168, 168, 168, .38);
    }

    .tasks-table {
      width: 90%;
      background-color: rgb(239, 239, 239);
      /* height: 500px; */
      margin-top: 100px;
    }

    .isDone {
      background-color: rgba(58, 250, 99, 0.707);
    }

    button {
      border: none;
      font-size: 20px;
      box-shadow: 5px 5px 15px rgba(168, 168, 168, .38);

    }

    button.circular {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      line-height: .5;
    }

    .white {
      color: white;
    }

    @media (min-width: 600px) {
      .tasks-table {
        width: 80%;
      }
    }

    @media (min-width: 1000px) {
      .tasks-table {
        width: 70%;
      }
    }
  </style>
</head>

<body>
  <div dir="rtl">

    <!--  CENTER DIV  -->
    <div style="display: flex; justify-content: center; align-items: center;">

      <!-- TASKS TABLE -->
      <div class="tasks-table">

        <!-- HEADER -->
        <header
          style="width: 100%; text-align: center; background-color: rgb(92, 52, 155);  color: white; padding-top: 8px ; padding-bottom: 8px ;">

          <h1 style="display: inline;">مهامي</h1>

          <button class="circular" onclick="addTask()"
            style="float: right; background-color: white; margin-right: 10px;">
            <span class="material-symbols-outlined ">
              add
            </span>
          </button>


        </header>
        <!--// HEADER //-->


        <!-- TASKS -->
        <div class="tasks" style="padding: 20px; ">

          <!-- TASK -->
          <!-- <div class="task" style="margin-bottom: 20px;"> -->

          <!-- TASK INFO  -->
          <!-- <div style="width: 70%; padding-right: 20px;">
                            <h2>قراءة كتاب</h2>

                            <div>
                                <span>10/10/10</span>
                            </div>
                        </div> -->
          <!--// TASK INFO  //-->


          <!-- TASK ACTION  -->
          <!-- <div style="display: flex; justify-content: space-between; align-items: center;  width: 25%;"  > 
                            <button class="circular white" style="background-color: rgb(114, 0, 0);  ">D</button>
                            <button class="circular white " style="background-color: rgb(0, 150, 30);">C</button>
                            <button class="circular white" style="background-color: rgb(0, 16, 197,.692);">E</button>
                        </div> -->
          <!--// TASK ACTION  //-->

          <!-- </div> -->

          <!--// TASK //-->



        </div>
        <!--// TASKS //-->

      </div>
      <!--// TASKS TABLE //-->

    </div>
    <!--//  CENTER DIV  //-->

  </div>
</body>

<script>
  let tasks = JSON.parse(localStorage.getItem("userTasks"));

  if (!tasks) {
    tasks = [];
    localStorage.setItem("userTasks", JSON.stringify(tasks));
  }
 


  const tasksContainer = document.querySelector(".tasks");

  renderTasks();

  async function addTask() {
    const { value: text } = await Swal.fire({
      title: "ادخل مهمة جديدة",
      input: "text",

      inputLabel: "قم بإضافة عنوان المهمة",
      inputValue: "",
      showCancelButton: true,
      inputValidator: (value) => {
        if (!value) {
          return "يجب عليك كتابة أيّ شيئ لحفظ مهمة جديدة";
        }
      }
    });
    let now = new Date();
    let fullDate = now.getDate() + "/" + (now.getMonth() + 1) + "/" + now.getFullYear() + "/" + " | " + now.getHours() + ":" + now.getMinutes();
    if (text) {
      Swal.fire("تمت إضافة المهمة بنجاح", "", "success");
      tasks.push({ title: text, check: false, date: fullDate });
      // localStorage.removeItem('userTasks');
      localStorage.setItem("userTasks", JSON.stringify(tasks));
      renderTasks();
    } else {
      Swal.fire(`تم إلغاء اضافة المهمة`);
    }
  }

  function checkTask(index) {

    tasks[index].check = tasks[index].check ? false : true;
    // localStorage.removeItem('userTasks');
    localStorage.setItem("userTasks", JSON.stringify(tasks));
    renderTasks();
  }


  function deleteTask(index) {
    Swal.fire({
      title: "هل أنت متأكد؟",
      text: "لن يمكنك التراجع عن هذا!",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "نعم، احذف",
      cancelButtonText: "إلغاء"
    }).then((result) => {
      if (result.isConfirmed) {
        tasks.splice(index, 1);
        // localStorage.removeItem('userTasks');
        localStorage.setItem("userTasks", JSON.stringify(tasks));
        renderTasks();

        Swal.fire("تم الحذف!", "تم حذف المهمة بنجاح", "success");
      }
    });
  }


  async function editTask(index) {

    const { value: text } = await Swal.fire({
      title: "هل تريد تعديل هذه المهمة؟ ",
      input: "text",
      inputLabel: "قم بتعديل المهمة الحالية",

      inputValue: tasks[index].title,
      showCancelButton: true,
      confirmButtonText: "حفظ",
      cancelButtonText: "إلغاء"
    });

    if (text) {
      tasks[index].title = text;
      Swal.fire("تم تعديل المهمة بنجاح", "", "success");
      // localStorage.removeItem('userTasks');
      localStorage.setItem("userTasks", JSON.stringify(tasks));
      renderTasks();
    } else {
      Swal.fire(`تم إلغاء تعديل هذه المهمة`);

    }
  }


  function renderTasks() {

  let userTasksFromStorage = JSON.parse(localStorage.getItem("userTasks")) || [];

    tasksContainer.innerHTML = "";

    for (let i = 0; i < userTasksFromStorage.length; i++) {


      tasksContainer.innerHTML += `
          <div class="task ${userTasksFromStorage[i].check ? 'isDone' : ''}" style="margin-bottom: 20px;">
            <div style="width: 70%; padding-right: 20px;">
              <h2>${userTasksFromStorage[i].title}</h2>
              <div>
                <span class="material-symbols-outlined">
                  calendar_month
                </span>
                <span>
                  ${userTasksFromStorage[i].date}
                </span>
              </div>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; width: 25%;">
            
              <button class="circular white"
                onclick="deleteTask(${i})"
                style="background-color: rgb(114, 0, 0);">
                <span class="material-symbols-outlined">delete</span>
              </button>
            ${userTasksFromStorage[i].check ? `<button class="circular white"
            onclick="checkTask(${i})"
            style="${userTasksFromStorage[i].check ? 'background-color: rgb(0, 150, 30)' : 'background-color:rgb(0 183 39 / 60%)'}" >
            <span class="material-symbols-outlined">close</span>
            </button>`
          :
          `<button class="circular white" 
            onclick="checkTask(${i})"
            style="${userTasksFromStorage[i].check ? 'background-color: rgb(0, 150, 30)' : 'background-color:rgb(0 183 39 / 60%)'}" >
            <span class="material-symbols-outlined">check</span>
            </button>`}
            
              <button class="circular white" onclick="editTask(${i})" style="background-color: rgb(0, 16, 197,.692);"><span class="material-symbols-outlined">edit</span></button>
            </div>
          </div>
        `;
    }
  }

</script>

</html>









<!-- 
قل لمن يفهم عني  ما أقول  قصر القول   فدا شرحٌ يطول
ثم سر غامض قصرت من دونه والله اعناق الفحول 
أنت لا تعرف أنت  ولا إياك 
لا ولا كيف الوصول 
لا ولا تدري صفات ركبت فيك حارت في خفاياها العقول 
أنت أكل الخبز لا تعرفه 
أين يجري منك أم كيف تبول 
كيف تدري من على العرش استوى  
لا تقل كيف استوى كيف النزول 
أين العقل منك إذا غلب النوم 
هيا قلي يا جهول 
أين الروح فيك كيف تجري وكيف تجول
فعصمت الجهول 

-->